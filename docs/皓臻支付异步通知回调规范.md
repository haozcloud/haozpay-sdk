<h2 id="88a6606f-3f42-420f-a8b1-93e92f7985d2" style="text-align: left;">一、接口说明</h2><div class="tableWrapper"><table style="min-width: 200px;"><colgroup><col style="min-width: 100px;"><col style="min-width: 100px;"></colgroup><tbody><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;"><strong>项目</strong></p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;"><strong>说明</strong></p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">用途</p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">当支付或退款状态发生变更时，皓臻支付平台主动向商户系统推送结果通知</p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">交互方式</p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">皓臻支付服务器通过HTTP POST请求商户配置的通知地址（notifyUrl）</p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">数据格式</p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">JSON（请求体与响应体均为JSON）</p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">编码约定</p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">Content-Type=application/json，字符编码UTF-8</p></td></tr></tbody></table></div><h2 id="16ae7de8-a0c2-4bf4-b5fd-40729a1aa387" style="text-align: left;">二、业务流程</h2><ol class="ordered-list" data-type="orderedList"><li><p>支付/退款操作完成后，平台触发通知事件</p></li><li><p>平台组装通知参数并生成签名</p></li><li><p>平台向商户notifyUrl发送POST请求</p></li><li><p>商户接收请求并验证签名</p></li></ol><h2 id="ca9aca91-bbf5-4930-b4e3-54697486803c" style="text-align: left;">三、请求参数</h2><div class="tableWrapper"><table style="min-width: 400px;"><colgroup><col style="min-width: 100px;"><col style="min-width: 100px;"><col style="min-width: 100px;"><col style="min-width: 100px;"></colgroup><tbody><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;"><strong>参数名</strong></p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;"><strong>类型</strong></p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;"><strong>必须</strong></p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;"><strong>描述</strong></p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">merchantNo</p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">String</p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">是</p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">平台分配的商户唯一标识</p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">timestamp</p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">Long</p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">是</p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">请求发送时的毫秒级时间戳</p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">sign</p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">String</p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">是</p></td><td colspan="1" rowspan="1" data-background-color="" style=""><p style="text-align: left;">签名值，用于验证请求合法性</p></td></tr></tbody></table></div><h2 id="448bc7df-5bb7-42b2-bf1c-a9d3d3a316df" style="text-align: left;">四、签名机制</h2><h3 id="9820b97c-bdc0-49be-a87e-47daeb7b9cd0" style="text-align: left;">（一）签名生成（平台端）</h3><ol class="ordered-list" data-type="orderedList"><li><p>收集所有非空参数（含公共参数和业务参数，排除sign字段）</p></li><li><p>按参数名ASCII码升序排序</p></li><li><p>按“参数名=参数值”格式用&amp;拼接成字符串（例：merchantNo=M123&amp;orderNo=O456）</p></li><li><p>用SHA256算法对字符串生成摘要</p></li><li><p>用平台私钥对摘要进行RSA加密，得到sign值</p></li></ol><h3 id="9304a2e3-3b8c-4dc2-a0df-d9c74d294afe" style="text-align: left;">（二）签名验证（商户端）</h3><ol class="ordered-list" data-type="orderedList"><li><p>接收请求参数，剔除sign字段</p></li><li><p>按与平台相同规则排序并拼接字符串</p></li><li><p>用SHA256算法生成摘要</p></li><li><p>用平台提供的公钥对请求中的sign值进行RSA解密，得到平台摘要</p></li><li><p>对比本地生成的摘要与解密后的平台摘要，一致则验签通过</p></li></ol><h2 id="fb75a7b1-6176-435d-b0f1-55bf1aa6b68f" style="text-align: left;">五、核心要求</h2><p style="text-align: left;">必须先验证签名通过后再处理业务逻辑，防止伪造请求</p>