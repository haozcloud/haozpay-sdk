<h1 id="d82c0b42-0c4a-4680-b9db-8fba521d7e21">环境地址</h1><p>生产环境地址：https://gate.haozpay.com</p><h1 id="afdb450c-356a-4902-8ba3-7829f19a7ee2"><span style="color: rgb(31, 35, 41);">接口规范</span></h1><div class="tableWrapper"><table style="min-width: 595px;"><colgroup><col style="min-width: 100px;"><col style="width: 495px;"></colgroup><tbody><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>交互方式：</strong></span></p></td><td colspan="1" rowspan="1" colwidth="495" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">接口均以<strong>API</strong>的服务形式提供；</span></p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>请求格式：</strong></span></p></td><td colspan="1" rowspan="1" colwidth="495" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">http post方式，以 <strong>json body&nbsp;</strong>形式提交参数</span></p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><strong>编码格式：</strong></p></td><td colspan="1" rowspan="1" colwidth="495" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p>请求参数：Content-Type = application/json</p><p>同步回调：Content-Type = application/json</p><p>异步回调：Content-Type = application/json</p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>返回格式：</strong></span></p></td><td colspan="1" rowspan="1" colwidth="495" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">JSON</span></p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>字符格式</strong>：</span></p></td><td colspan="1" rowspan="1" colwidth="495" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">UTF-8</span></p></td></tr></tbody></table></div><h1 id="918281c4-0fba-4938-82d3-304c81f63d38">接口定义</h1><h2 id="0f61677c-51ec-4694-88e4-3b65cb5b4dd1">&nbsp; 1.&nbsp;<span style="color: rgb(31, 35, 41);">接口请求公共参数定义</span></h2><p><span style="color: rgb(31, 35, 41);"><strong>接口请求调起说明：</strong></span></p><ul class="bullet-list" data-type="bulletList"><li><p>请求的编码格式为Content-Type = application/json</p></li><li><p><span style="color: rgb(31, 35, 41);">对应业务接口的参数请置入bizBody参数下，对应为json对象格式</span></p></li></ul><div class="tableWrapper"><table style="min-width: 600px;"><colgroup><col style="min-width: 100px;"><col style="min-width: 100px;"><col style="min-width: 100px;"><col style="min-width: 100px;"><col style="min-width: 100px;"><col style="min-width: 100px;"></colgroup><tbody><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>参数名</strong></span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>参数说明</strong></span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>是否必填</strong></span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>类型</strong></span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>长度</strong></span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>示例/说明</strong></span></p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">merchantNo</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">平台商户号</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">是</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">String</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">20</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">入驻皓臻支付平台后自动生成</span></p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">sign</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">签名</span></p><p></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">是</span></p><p></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">String</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">除开sign参数，其余字段根据字典序升序，</span><span style="color: rgb(216, 57, 49);">根据<strong>商户私钥</strong>生成</span></p><p><span style="color: rgb(216, 57, 49);">如果有参数值为null，签名串中应当<strong>略过</strong>处理</span></p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">timestape</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">时间戳</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">是</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">Long</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p>毫秒级时间戳</p></td></tr></tbody></table></div><h2 id="78367777-32f6-45cf-9ef5-4b18107c5597"><span style="color: rgb(31, 35, 41);">2. 接口公共返回参数定义</span></h2><ul class="bullet-list" data-type="bulletList"><li><p>回调方式有两种 <strong>同步回调</strong>（即请求接口同步返回结果）、<strong>异步回调</strong>（即请求接口，不会立即返回最终结果，系统处理完成后会请求填写的回调地址通知到商户的回调接口）：</p><ul class="bullet-list" data-type="bulletList"><li><p>同步回调：调起时同步返回，接收编码格式为Content-Type = application/json</p></li><li><p>异步回调：订单处理后通过请求调起是上传的参数<span style="color: rgb(31, 35, 41);"><strong>notifyUrl</strong>地址回调，接收编码格式为Content-Type = </span>application/json，请求方式为 <strong>POST</strong>，请求参数形式为 <strong>Body</strong>体</p></li></ul></li></ul><div class="tableWrapper"><table style="min-width: 600px;"><colgroup><col style="min-width: 100px;"><col style="min-width: 100px;"><col style="min-width: 100px;"><col style="min-width: 100px;"><col style="min-width: 100px;"><col style="min-width: 100px;"></colgroup><tbody><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>参数名</strong></span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>参数说明</strong></span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>是否必填</strong></span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>类型</strong></span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>长度</strong></span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);"><strong>示例/说明</strong></span></p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">code</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">请求状态码</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">是</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">Integer</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p>每次请求处理结果状态码，<strong>0为处理成功（部分特定场景不代表处理完成，如需要异步回调通知的接口；只是代表本次请求处理成功）</strong></p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">message</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">状态描述</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">是</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">String</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p></p></td></tr><tr class="table-row"><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">data</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">结果数据</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">否</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">Object</span></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p></p></td><td colspan="1" rowspan="1" data-background-color="" data-font-size="10pt" style="font-size: 10pt;"><p><span style="color: rgb(31, 35, 41);">如果存在需要返回的业务信息，会在该字段中返回</span></p></td></tr></tbody></table></div><p></p><h1 id="bf7948b6-72a2-41da-b32b-87d6ab776b08">接口签名说明</h1><h2 id="deddc684-d3d3-44e0-8487-19e123783001"><span style="color: rgb(31, 35, 41);">签名规范</span></h2><ul class="bullet-list" data-type="bulletList"><li><p><span style="color: rgb(31, 35, 41);">商户端的平台业务系统和皓臻支付系统生成各自RSA公私钥，生成密钥后交换各自RSA公钥。</span></p><ul class="bullet-list" data-type="bulletList"><li><p><span style="color: rgb(31, 35, 41);">商户需要生成一对公私钥，将公钥配置到皓臻支付平台商户管理控台→账户管理→开发信息管理→商户签名公钥中，私钥配置在商户端的平台业务系统中（<strong>请妥善保管请勿泄露</strong>）。</span></p></li><li><p><span style="color: rgb(31, 35, 41);">商户端平台业务系统也需要将皓臻支付平台商户管理控台→账户管理→开发信息管理→皓臻支付公钥配置到商户业务系统中</span></p></li><li><p><span style="color: rgb(31, 35, 41);">生成公私钥说明，签名算法：</span><span style="color: rgb(216, 57, 49);"><strong>SHA256WithRSA算法</strong></span><span style="color: rgb(31, 35, 41);">不一致会导致验签失败。</span></p></li></ul></li></ul><h2 id="d2c0ebaf-95aa-4aa3-8c07-ba7ff5af3716">生成公私钥</h2><h3 id="b7bc64a2-c001-4eeb-a9dc-889c370b75a7">使用皓臻支付提供的密钥生成工具生成</h3><p>Coming soon</p><h3 id="aca02746-5cb6-42a9-ba1f-4fd6ab551879">使用开源工具生成</h3><ul class="bullet-list" data-type="bulletList"><li><p><span style="color: rgb(31, 35, 41);"><strong>生成RSA私钥</strong></span></p><ul class="bullet-list" data-type="bulletList"><li><p><span style="color: rgb(31, 35, 41);">openssl genrsa -out rsa_private_key.pem 2048</span></p></li></ul></li><li><p><span style="color: rgb(31, 35, 41);"><strong>生成RSA公钥</strong></span></p><ul class="bullet-list" data-type="bulletList"><li><p><span style="color: rgb(31, 35, 41);">openssl rsa -in rsa_private_key.pem -pubout -out rsa_public_key.pem</span></p></li></ul></li><li><p><span style="color: rgb(31, 35, 41);"><strong>3.将RSA私钥转换成PKCS8格式</strong>（第1步生成的RSA私钥还不能被使用，需要进行PKCS#8编码）</span></p><ul class="bullet-list" data-type="bulletList"><li><p><span style="color: rgb(31, 35, 41);">openssl pkcs8 -topk8 -in rsa_private_key.pem -out pkcs8_rsa_private_key.pem -nocrypt</span></p></li></ul></li></ul><h2 id="04088016-14c9-43fc-9583-7d0a996d9a6f">签名算法</h2><h3 id="b66f34d0-21c2-4a04-bd85-473d2a388c54">请求接口签名</h3><ol class="ordered-list" data-type="orderedList"><li><p>请求的业务接口，除开sign参数，其余参数进行字典序升序排列，如果对应的参数值为null，则略过该参数，最终生成形如 “参数A=A参数值&amp;参数B=B参数值……参数N=N参数值”的单行字符串文本 <strong>paramsStr</strong>。</p></li><li><p>对&nbsp;<strong>paramsStr&nbsp;</strong>进行 SHA256摘要加密，得到 <strong>sha256ParamsStr。</strong></p></li><li><p>对&nbsp;<strong>sha256ParamsStr </strong>使用&nbsp;<strong>商户私钥 </strong>进行<span style="color: rgb(246, 78, 84);"><strong>RSA加密</strong></span>，得到 <strong>encryptParamsStr</strong>。</p></li><li><p>将&nbsp;<strong>encryptParamsStr </strong>回填至 <strong>sign&nbsp;</strong>字段中，之后进行接口请求。</p></li></ol><p>以下为示例代码</p><pre><code class="language-java">
        Map&lt;String, String&gt; paramsMap = new HashMap&lt;&gt;();
        paramsMap.put("reqSeqId", UUID.randomUUID().toString());
        paramsMap.put("orderNo", "P0123456789101");
        paramsMap.put("merchantNo", "HZ1001");
        paramsMap.put("amount", "10000");
        paramsMap.put("clientIp", "192.168.0.111");
        paramsMap.put("returnUrl", "https://www.baidu.com");
        paramsMap.put("notifyUrl", "https://www.baidu.com");
        paramsMap.put("timestamp", "20190723141000");

        // 参数名ASCII码从小到大排序（字典序）；
        // 如果参数的值为空不参与签名；
        // 签名串
        StringBuilder sb = new StringBuilder();
        paramsMap.keySet().stream().sorted().forEach(key -&gt; {
            String value = paramsMap.get(key);
            if (value!= null &amp;&amp; !value.isEmpty()) {
                sb.append(key).append("=").append(value).append("&amp;");
            }
        });
        sb.deleteCharAt(sb.length() - 1);
        // 进行sha256摘要签名
        String sign = SecureUtil.sha256(sb.toString());

        // 使用商户私钥进行加密
        String encryptedSign = rsa.encryptBase64(sign, KeyType.PrivateKey);</code></pre><h3 id="ab1ee81a-a26d-4b07-9b59-fc99905963ce">异步通知验签</h3><p>步骤请参考请求接口加签步骤（需要注意的是 回调的签名是皓臻支付通过平台密钥进行加密的，故而商户侧应用需要<span style="color: rgb(63, 68, 65);"><strong>使用皓臻支付</strong></span><span style="color: rgb(246, 78, 84);"><strong>平台公钥</strong></span><span style="color: rgb(63, 68, 65);"><strong>进行解密</strong></span>），再进行对比签名是否一致，不一致则商户业务系统不处理该请求，可能为三方<span style="color: rgb(246, 78, 84);"><strong>恶意用户伪造</strong></span>的请求。</p>